# HTTP

*Модуль для работы с `http`-сервером*

`requestListener(req, res)` - Функция обработки запроса, вызывается при создании сервера, автоматически добавляется к событию `request` и в качестве аргументов принимает `req` - объект запроса к серверу и `res` - объект ответа от сервера

```javascript
const handleRequest = (req, res) => {
    res.writeHead(200, {'Content-Type': 'text/plain'});
    res.end('The end');
};
```

## Свойства и методы модуля `HTTP`

* [`http.Server`]() - Свойство. Содержит в себе объект сервера. *Честный случай `Event Emitter`*
* `http.createServer(fn(req, res))` - Метод. Возвращает экземпляр объекта сервера `http.Server`

## Свойства и методы объекта сервера `http.Server`

* `server.listen(port, hostname, callback)` - Метод. Устанавливает прослушивание сервера `(server)` на порту `(port)` хостинга `(hostname)`. После отработки вызывается `callback`-функция `(callback)`

```javascript
server.listen(3000, 'localhost', () => console.log('Listening on http://localhost:3000'));
```

## События объекта сервера `http.Server`
* `request` - Событие объекта сервера `http.Server`. Срабатывает при входящем запросе
  * `server.on('request', fn(req, res))` - Обработка события, которое автоматически инициируется при входящем запросе. Обрабатывается функцией обработчиком `(fn)`, которая принимает аргументы: `(req)` - объект запроса (из него читаем), `(res)` - объект ответа (в него пишем)
* `listening` - Событие объекта сервера `http.Server`. Установка сервера на прослушку
* `connection` - Событие объекта сервера `http.Server`. Браузер открывает с сервером новое соединение

## Свойства и методы класса `request`

* `req.method` - Свойство объекта `req`. Содержит в себе `HTTP`-метод, которым был отправлен запрос
* `req.url` - Свойство объекта `req`. Содержит в себе адрес запроса от корня хоста
* `req.headers` - Свойство объекта `req`. Содержит в себе объект с заголовками, которые отправил браузер

## Свойства и методы класса `http.ServerResponse`

* `res.statusCode` - Свойство объекта `res`. Содержит в себе http-статус ответа от сервера. *(По умолчанию 200)*
* `res.writeHead(statusCode, message, headers)` - Метод объекта `res`. Посылает заголовки ответа на запрос. В качестве аргументов принимает `(statusCode)` - код состояния `HTTP`, `(message)` - необязательное описания состояния и необязательный объект заголовков `(headers)`

```javascript
var body = 'hello world';
response.writeHead(200, {
  'Content-Length': Buffer.byteLength(body),
  'Content-Type': 'text/plain' });
```

* `res.setHeader(header, value)` - Метод объекта `res`. Отправляет заголовок `(header)` со значением `(value)`
* `res.removeHeader(header)` - Метод объекта `res`. Удаляет заголовок `(header)`

* `res.end(str)` - Метод объекта `res`. Отправляет серверу сигнал с необязательным сообщением `(str)` что были отправлены все заголовки и тело ответа; что сервер должен считать это сообщение завершенным

## Заголовки и их значения

* `Content-Type` - Заголовок. Тип ожидаемого контента *(строка)*
  * `text/plain` - Ответ. Обычный текст
  * `text/html` - Ответ. `HTML`-файл
  * `text/css` - Ответ. `CSS`-файл
  * `application/x-javascript` - Ответ. `JavaScript`-файл
  * `application/json` - Ответ. `JavaScript`-файл
  * `application/x-shockwave-flash` - Ответ. `Flash`-файл
  * `image/png` - Ответ. Изображение `*.png`
  * `image/jpeg` - Ответ. Изображение `*.jpg` или `*.jpeg`
  * `image/gif` - Ответ. Изображение `*.gif`
* `Content-Length` - Заголовок. Длина ожидаемого ответа в байтах *(число)*
* `Cache-Control` - Заголовок. Отвечает за кеширование результатов ответа сервера
  * `no-cache` - Ответ. Отмена кеширования в рамках сессии
  * `no-store` - Ответ. Полная отмена кеширования

## Статусы ответа

* `200` - Успешный ответ `Ok`
* `403` - Доступ запрещен
* `404` - Файл не найден `Not found`
* `500` - Серверная ошибка