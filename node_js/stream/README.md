# Потоки

*Поток это JS-объект, который получает информацию о ресурсе (в данном случае файл) и который умеет с этим ресурсом работать*

* *`stream.Readable` - Класс. Поток на чтение*
  * `fs.ReadStream` - поток для чтения из файла
  * `request` - объект для обработки запроса посетителя
* *`stream.Writable` - Класс. Поток на запись*
  * `fs.WriteStream` - поток для записи в файл
  * `response` - объект для записи ответа от сервера

`readable.pipe(writable)` - Общий метод для потоков. Берет считанное из потока `(readable)` и пишет его в поток записи `(writable)`

## Поток на чтение файла

* `const stream = new fs.ReadStream([file])` - Создание экземпляра потока на чтение для файла `(file)`
* `stream.read()` - Метод. Чтение файла из потока `(stream)`. Возвращает содержимое файла
* `stream.destroy()` - Метод. Завершает чтение файла из потока `stream`

## События потока чтения

* `open` - Событие. Файл открыт на чтение
* `readable` - Событие. Файл начал считываться
* `end` - Событие. Файл закончил считываться
* `close` - Событие. Файл закрывается на чтение
* `error` - Событие. Возникновение ошибки

## Поток на запись файла

*`new stream.Writable` - как правило это объект `response`*

* `res.write(data)` - Метод потока на запись файла, объекта `(res)`. Записывает данные `(data)` в файл. Эти данные добавляются к свойству потока *буфер*. Если буфер не сильно заполнен, то возвращается `true`, что означает, что мы можем писать еще (дальнейшую отсылку берет на себя сам поток). Если внутренний буфер потока переполнен, то возвращается `false`
* `res.end([data])` - Метод потока на запись файла, объекта `(res)`. Указывает на завершение потока записи в файл. Метод может вывести необязательные данные `(data)`
* `res.destroy()` - Метод потока на запись файла, объекта `(res)`. Разрушение потока записи

## События потока записи

* `drain` - Событие потока записи. Вызывается потоком, когда он освобождается. Т.е. когда его внутренний буфер опустеет
* `finish` - Событие потока записи. Вызывается потоком, когда запись полностью завершена. Успешное ее окончание
* `close` - Событие потока записи. Сигнализирует, что соединение было оборвано. Окончание с ошибкой