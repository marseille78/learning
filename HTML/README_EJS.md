# ejs

## Компилляция

**Создание шаблона:**

*Рендеринг HTML-строки (вариант 1)*

```javascript
let template = ejs.compile(str, options);
template(data);
// => Rendered HTML string
```

*Рендеринг HTML-строки (вариант 2)*

```javascript
ejs.render(str, data, options);
// => Rendered HTML string
```

*Рендеринг из файла*

```javascript
ejs.renderFile(filename, data, options, function(err, str){
  // str => Rendered HTML string
});
```

*Опции:*

* `cache` - Скомпилированные функции кэшируются, требуется `filename`
* `filename` - Имя отображаемого файла. Не требуется, если вы используете `renderFile()`. Используется `cache` для ключевых кешей и для включений модулей.
* `root` - Установить корень проекта для включений с абсолютным путем (/file.ejs).
* `context` - Контекст выполнения функции
* `compileDebug` - Когда `false` отладочные инструменты не скомпилированы
* `client` - Когда `true`, компилирует функцию, которая может быть отображена в браузере без необходимости загрузки EJS Runtime ([ejs.min.js](https://github.com/mde/ejs/releases/latest)).
* `delimiter` - Символ для использования с угловыми скобками для открытия/закрытия
* `debug` - Вывод сгенерированной функции тела
* `strict` - Когда установлено `true`, сгенерированная функция находится в строгом режиме
* `_with` - Следует ли использовать `with() {}` конструкции. Если `false` тогда местные жители будут храниться в `locals` объекте. Установите `false` в строгом режиме.
* `destructuredLocals` - Массив локальных переменных, которые всегда деструктурированы из объекта locals, доступны даже в строгом режиме.
* `localsName` - Имя, используемое для объекта, хранящего локальные переменные, когда по `with` умолчанию не используется `locals`
* `rmWhitespace` - Удалите все безопасные для удаления пробелы, включая начальные и конечные пробелы. Это также обеспечивает более безопасную версию `-%>` выпадения строк для всех тегов скриптлета (при этом не удаляются новые строки тегов в середине строки).
* `escape` - Экранирующая функция, используемая с `<%=` конструкцией. Он используется при рендеринге и используется `.toString()` при генерации клиентских функций. (По умолчанию экранирует XML).
* `outputFunctionName` - Установите в строку (например, «echo» или «print») функцию, которая будет печатать выходные данные внутри тегов скриптлета.
* `async` - Когда `true` EJS будет использовать асинхронную функцию для рендеринга. (Зависит от поддержки async / await во время выполнения JS.

## Теги вставки

* `<% CODE %>` - Вставка EJS-кода
* `<%= STR %>` - Вставка строчных значений
* `<%- HTML %>` - Вставка HTML-структур

## Логика

*Комментарий:*

```javascript
<%# STRING %>
```

*Условия:*

```javascript
<% if (BOOL) { %>
  CODE1
<% } else { %>
  CODE2
<% } %>
```

```javascript
<div class="<%= BOOL ? VAL1 : VAL2 %>"><%= STR %></div>
```

*Циклы:*

```javascript
// ARR - перебираемый массив
// item - элемент массива
<% ARR.forEach((item) => { %>
  <div><%= item %></div>
<% }) %>
```

*Вывод данных в цикле при помощи функций:*

```javascript
// FUN - функция перебора массива
// ITEM - данные текущего элемента массива
// ITEM.PROP - свойство данных текущего элемента массива
<% function FUN(ITEM) { %>
  <li><%= ITEM.PROP %></li>
<% } %>

// DATA - переданные данные
// DATA.FIELD - поле переданных данных, которое содержит массив
// FUN - функция рендера, которая вызывается при переборе данных
<ul>
  <% DATA.FIELD.map(FUN) %>
</ul>
```